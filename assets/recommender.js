(()=>{"use strict";var e,t,i={177:(e,t,i)=>{i.d(t,{L:()=>n});const n=new class{constructor(e){let t;try{t=window[e]}catch(t){console.warn(`[rcm] Unavailable browserStorage type - ${e}`)}this.storage=t}getItem(e){let t=null;return this.storage&&(t=this.storage.getItem(e)),t}setItem(e,t){this.storage&&this.storage.setItem(e,t)}removeItem(e){this.storage&&this.storage.removeItem(e)}}("localStorage")},705:(e,t,i)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}function o(e,t,i){return(t=r(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,{A:()=>o})},743:(e,t,i)=>{i.d(t,{N1:()=>n,PK:()=>r,gh:()=>o});const n=window.navigator?.userAgent.toString()||"",r=()=>{if("function"!=typeof Object.fromEntries)return!1;for(const e of["fetch","IntersectionObserver"])if("function"!=typeof window[e])return!1;return!0},o=()=>{const e=o;if(void 0===e.r)if(e.r=null,window.navigator?.webdriver)e.r="webdriver";else{const t=["headlesschrome","blp_bbot","bytespider","googlebot","gptbot","petalbot","yandexbot"],i=n.toLowerCase();for(const n of t)if(i.includes(n)){e.r=`userAgent (${n})`;break}}return e.r}},805:(e,t,i)=>{i.d(t,{v:()=>a});var n=i(705),r=i(890),o=i(177);const s=Boolean(o.L.getItem("rcmLoggerEnabled")),d=Boolean(o.L.getItem("rcmSentryEnabled"));const a=new class{shouldSendToSentry(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return!(e<=0)&&(!!(e>=100||d)||function(e,t){const i=e-.5+Math.random()*(t-e+1);return Math.round(i)}(1,100)<=e)}constructor(){(0,n.A)(this,"isLoggerEnabled",s),(0,n.A)(this,"tags",[]),console.log("rcm logger "+(this.isLoggerEnabled?"enabled":"disabled")),console.log("rcm sentry "+(d?"enabled":"auto"))}async captureInSentry(e){const{captureEvent:t}=await i.e(326).then(i.bind(i,47));t(e)}setTags(e){this.tags=e}log(e,t){(t||void 0===t&&this.isLoggerEnabled)&&console.log(...e)}error(e){let{error:t,message:i,tags:n=[],fingerprint:o,forcedHeadlessSentry:s=!1,isConsole:d,sentryPercentage:a}=e;if(d||void 0===d&&this.isLoggerEnabled){const e=i?` ${i};`:"";console.error(`[rcm error]${e}`,t)}this.shouldSendToSentry(a)&&(o||(i?o=[i]:"string"==typeof t&&(o=[t])),this.captureInSentry({event:t,logLevel:r.$.Error,tags:[...this.tags,...n],fingerprint:o,forcedHeadlessSentry:s}))}info(e){let{message:t,tags:i=[],fingerprint:n,forcedHeadlessSentry:o=!1,isConsole:s,sentryPercentage:d}=e;(s||void 0===s&&this.isLoggerEnabled)&&console.info(`[rcm info] ${t}`),this.shouldSendToSentry(d)&&(n||(n=[t]),this.captureInSentry({event:t,logLevel:r.$.Info,tags:[...this.tags,...i],fingerprint:n,forcedHeadlessSentry:o}))}warn(e){let{message:t,tags:i=[],fingerprint:n,forcedHeadlessSentry:o=!1,isConsole:s,sentryPercentage:d}=e;(s||void 0===s&&this.isLoggerEnabled)&&console.warn(`[rcm warn] ${t}`),this.shouldSendToSentry(d)&&(n||(n=[t]),this.captureInSentry({event:t,logLevel:r.$.Warning,tags:[...this.tags,...i],fingerprint:n,forcedHeadlessSentry:o}))}}},890:(e,t,i)=>{i.d(t,{$:()=>n});let n=function(e){return e.Error="error",e.Warning="warning",e.Info="info",e}({})},974:(e,t,i)=>{i.d(t,{Fh:()=>l,Qd:()=>a,ko:()=>c,nF:()=>u});const n={},r=n.toString,o=n.hasOwnProperty,s=o.toString,d=s.call(Object);function a(e){if(!e||"[object Object]"!==r.call(e))return!1;const t=Object.getPrototypeOf(e);if(!t)return!0;const i=o.call(t,"constructor")&&t.constructor;return"function"==typeof i&&s.call(i)===d}const c=e=>"string"==typeof e&&!!e.trim().length;function u(e,t){let i,n,r=!1;return function o(){for(var s=arguments.length,d=new Array(s),a=0;a<s;a++)d[a]=arguments[a];if(r)return i=d,void(n=this);e.apply(this,d),r=!0,setTimeout((()=>{r=!1,i&&(o.apply(n,i),i=n=null)}),t||100)}}function l(e){const t=Object.entries(e).filter((e=>{let[,t]=e;return null!=t}));return Object.fromEntries(t)}}},n={};function r(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={exports:{}};return i[e](o,o.exports,r),o.exports}r.m=i,r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,i)=>(r.f[i](e,t),t)),[])),r.u=e=>"rcm."+{9:"microdata",180:"video",249:"bindblock",326:"sentry",530:"bindsearch"}[e]+"."+{9:"91910f",180:"4a7341",249:"8e8962",326:"ca572c",530:"6f64a1"}[e]+".js",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="recommender.js:",r.l=(i,n,o,s)=>{if(e[i])e[i].push(n);else{var d,a;if(void 0!==o)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var l=c[u];if(l.getAttribute("src")==i||l.getAttribute("data-webpack")==t+o){d=l;break}}d||(a=!0,(d=document.createElement("script")).charset="utf-8",d.timeout=120,r.nc&&d.setAttribute("nonce",r.nc),d.setAttribute("data-webpack",t+o),d.src=i),e[i]=[n];var h=(t,n)=>{d.onerror=d.onload=null,clearTimeout(m);var r=e[i];if(delete e[i],d.parentNode&&d.parentNode.removeChild(d),r&&r.forEach((e=>e(n))),t)return t(n)},m=setTimeout(h.bind(null,void 0,{type:"timeout",target:d}),12e4);d.onerror=h.bind(null,d.onerror),d.onload=h.bind(null,d.onload),a&&document.head.appendChild(d)}},r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var n=i.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=i[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),(()=>{var e={498:0};r.f.j=(t,i)=>{var n=r.o(e,t)?e[t]:void 0;if(0!==n)if(n)i.push(n[2]);else{var o=new Promise(((i,r)=>n=e[t]=[i,r]));i.push(n[2]=o);var s=r.p+r.u(t),d=new Error;r.l(s,(i=>{if(r.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;d.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",d.name="ChunkLoadError",d.type=o,d.request=s,n[1](d)}}),"chunk-"+t,t)}};var t=(t,i)=>{var n,o,[s,d,a]=i,c=0;if(s.some((t=>0!==e[t]))){for(n in d)r.o(d,n)&&(r.m[n]=d[n]);if(a)a(r)}for(t&&t(i);c<s.length;c++)o=s[c],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0},i=globalThis.rcmjsWebpackChunkGlobal=globalThis.rcmjsWebpackChunkGlobal||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();let o=function(e){return e.Pending="pending",e.Ready="ready",e}({});var s=r(974);const d={};function a(e,t,i){const n=String(t).split(".");for(let t=0;t<n.length;t++){if(3===arguments.length)t+1===n.length?e[n[t]]=i:(0,s.Qd)(n[t])||(e[n[t]]={});else if(void 0===e[n[t]])return;e=e[n[t]]}return e}const c={get:e=>e?a(d,e):d,set(e,t){a(d,e,t)}};var u=r(805);let l=null,h=null;const m=new Map;let p=null,v=null;const f=new Map;var g=r(705),b="adtech_uid",y=function(){function e(e){this.regValidKey=new RegExp("([a-zA-Z0-9_-]{0,})","i"),this.hash=e||location.hostname}return e.prototype.isSupported=function(){return"object"==typeof document&&"string"==typeof document.cookie},e.prototype.setItem=function(e,t,i,n,r,o,s,d){void 0===e&&(e=!0),void 0===n&&(n=30),void 0===r&&(r="/"),void 0===o&&(o=location.hostname.split(".").slice(-2).join(".")),void 0===s&&(s="https:"===location.protocol),void 0===d&&(d=!0);try{if("boolean"==typeof e&&"string"==typeof t&&this.regValidKey.test(t)&&"string"==typeof i&&(""===i||this.regValidKey.test(i))&&"number"==typeof n&&"string"==typeof r&&"string"==typeof o&&-1!==location.hostname.indexOf(o)&&"boolean"==typeof s&&s===("https:"===location.protocol)){var a=document.createElement("a");if(a.href="http://"+o+r,a.hostname===o||a.pathname===r){if(!e||this.isSupported()){var c="";c+=d?this.hash+"_"+t:t;var u=new Date;u.setTime(u.getTime()+24*n*60*60*1e3);var l=u.toUTCString();return i=encodeURIComponent(i),document.cookie=c+"="+i+(l?"; expires="+l:"")+(r?"; path="+r:"")+(o?"; domain="+o:"")+(s?"; secure":""),this.getItem(e,t,d)===decodeURIComponent(i)}return!1}return!1}return!1}catch(e){return!1}},e.prototype.getItem=function(e,t,i){void 0===e&&(e=!0),void 0===i&&(i=!0);try{if("boolean"!=typeof e||"string"!=typeof t||!this.regValidKey.test(t))return!1;if(e&&!this.isSupported())return!1;i&&(t=this.hash+"_"+t);for(var n=document.cookie.split(";"),r=[],o=0;o<n.length;o++){var s=n[o],d=this._getCookieParts(s),a=d.left,c=d.right;a===t&&r.push(decodeURIComponent(c))}if(0===r.length)return!1;if(1===r.length)return r[0];try{var u=1/0,l=void 0;for(o=0;o<r.length;o++){var h=r[o].split(":")[1].split(".").length;h<u&&(u=h,l=r[o])}return l||!1}catch(e){return!1}}catch(e){return!1}},e.prototype.removeItem=function(e,t){void 0===e&&(e=!0);try{return!("boolean"!=typeof e||"string"!=typeof t||!this.regValidKey.test(t))&&(!(e&&!this.isSupported())&&(this.setItem(e,t,"",-86400),!1===this.getItem(e,t)))}catch(e){return!1}},e.prototype.getKeys=function(e){void 0===e&&(e=!0);try{if("boolean"==typeof e){if(!e||this.isSupported()){for(var t=[],i=document.cookie.split(";"),n=0;n<i.length;n++){var r=i[n],o=this._getCookieParts(r).left;0===o.indexOf(this.hash)&&t.push(o.substr(this.hash.length+1))}return t}return[]}return[]}catch(e){return[]}},e.prototype.clear=function(e){void 0===e&&(e=!0);try{if("boolean"==typeof e){if(!e||this.isSupported()){var t=this.getKeys(e);if(t)for(var i=0;i<t.length;i++){var n=t[i];this.removeItem(e,n)}return 0===this.getKeys(e).length}return!0}return!1}catch(e){return!1}},e.prototype._getCookieParts=function(e){var t=e.indexOf("=");return t<0?{left:"",right:""}:{left:e.slice(0,t).trim(),right:e.slice(t+1,e.length).trim()}},e}();const I=y;var k,w=function(){function e(){this.cookieStore=new I}return e.prototype.getItem=function(e){var t=this.cookieStore.getItem(!0,e,!1);return"boolean"!=typeof t&&t},e.prototype.setItem=function(e,t,i){return this.cookieStore.setItem(!0,e,t,365,"/",i,"https:"===location.protocol,!1)},e}(),_=new Uint8Array(16);function S(){if(!k&&!(k="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return k(_)}const E=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const C=function(e){return"string"==typeof e&&E.test(e)};for(var x=[],T=0;T<256;++T)x.push((T+256).toString(16).substr(1));const P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(x[e[t+0]]+x[e[t+1]]+x[e[t+2]]+x[e[t+3]]+"-"+x[e[t+4]]+x[e[t+5]]+"-"+x[e[t+6]]+x[e[t+7]]+"-"+x[e[t+8]]+x[e[t+9]]+"-"+x[e[t+10]]+x[e[t+11]]+x[e[t+12]]+x[e[t+13]]+x[e[t+14]]+x[e[t+15]]).toLowerCase();if(!C(i))throw TypeError("Stringified UUID is invalid");return i};const A=function(e,t,i){var n=(e=e||{}).random||(e.rng||S)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){i=i||0;for(var r=0;r<16;++r)t[i+r]=n[r];return t}return P(n)};const O=function(e){if(!C(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)};var R=function(){function e(){this.uuid="",this.scope=""}return e.prototype.parse=function(e){try{var t=e.split(":");if(2!==t.length)return!1;var i=t[0],n=t[1];return!!function(e){return C(e)&&4===O(e)}(i)&&(this.uuid=i,this.scope=n,!0)}catch(e){return!1}},e.prototype.getID=function(){return{scope:this.scope,uuid:this.uuid}},e.prototype.generate=function(e){this.uuid=A(),this.scope=e},e.prototype.getJoined=function(){return[this.uuid,this.scope].join(":")},e}(),F=function(e,t,i){if(i||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},L=function(){function e(){this.storeFacade=new w}return e.prototype.getID=function(){var e=this.storeFacade.getItem(b);return e?this.getCurrentUID(e):this.generateAndSave()},e.prototype.generateAndSave=function(){var e=this.getScopeDomains(),t=this.tryToSetAllDomains(e);return t?t.getID():{scope:null,uuid:null}},e.prototype.getCurrentUID=function(e){var t=new R;if(t.parse(e)){var i=t.getID();return i.scope&&i.uuid&&this.storeFacade.setItem(b,e,i.scope),i}return this.generateAndSave()},e.prototype.tryToSetAllDomains=function(e){for(var t=0;t<e.length;t++){var i=e[t],n=new R;n.generate(i);var r=n.getJoined();if(this.storeFacade.setItem(b,r,i))return n}},e.prototype.getScopeDomains=function(e){void 0===e&&(e=location.hostname);var t=e.split(".");if(t.length<=1)return t;for(var i=[],n=0;n<t.length-1;n++){var r=t[n];i.unshift(F([r],t.slice(n+1),!0).join("."))}return i},e}();let U=(e=21)=>{let t="",i=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&i[e]];return t},q=function(e){return e.Beacon="beacon",e.Xhr="xhr",e}({});const V=6e4,B=[5e3,1e4,3e4,6e4,2*V,3*V,5*V,8*V,78e4,21*V,34*V];function $(e){let t,i=1,n=null,r=!1,o=0;const d=[{eventName:"scroll",value:0},{eventName:"mousemove",value:0},{eventName:"click",value:0},{eventName:"keydown",value:0},{eventName:"resize",value:0}].map(((e,t)=>({...e,eventHandler:(0,s.nF)((()=>d[t].value++),250)})));function a(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q.Xhr;const r=Date.now(),s=r-t,a={activityCounters:d.map((e=>e.value)).join("_"),activityDurations:(c=s,d.map((e=>Math.min(250*e.value,c))).join("_")),duration:s,num:i++};var c;e.onPing(a,n),d.forEach((e=>{e.value=0})),o+=s,t=r}function c(){const e=function(){let e=null;for(const t of B)if(o<t){e=t-o;break}return e}();e?n=window.setTimeout((()=>{a(),c()}),e):m(!1)}function u(){h(!0)}function l(){const e=document.visibilityState;"visible"===e?function(){if(r)return;r=!0,t=Date.now(),c()}():"hidden"===e&&h(!0)}function h(e){r&&(r=!1,n&&window.clearTimeout(n),n=null,e&&a(q.Beacon))}function m(e){h(e),document.removeEventListener("visibilitychange",l),window.removeEventListener("pagehide",u),d.forEach((e=>window.removeEventListener(e.eventName,e.eventHandler)))}return document.addEventListener("visibilitychange",l),window.addEventListener("pagehide",u),d.forEach((e=>window.addEventListener(e.eventName,e.eventHandler))),l(),m}class j{constructor(){(0,g.A)(this,"stopActivityTracker",null),this.reset()}start(e){this.stop();const t={onPing:e};this.stopActivityTracker=$(t)}stop(){this.stopActivityTracker&&this.stopActivityTracker(!0),this.reset()}reset(){this.stopActivityTracker=null}}class D{constructor(){(0,g.A)(this,"resendList",null),(0,g.A)(this,"resendTailElem",null)}push(e){const t={data:e,next:null};this.resendList?this.resendTailElem.next=t:this.resendList=t,this.resendTailElem=t}shift(){if(this.resendList){const e=this.resendList.data;return this.resendList=this.resendList.next,e}return null}get isEmpty(){return!this.resendList}}class M{constructor(e){(0,g.A)(this,"eventNumber",1),this.endpoint=e.endpoint??"https://rcm-tr.rambler.ru/tr/",this.queue=new D,this.isFirefox=window.navigator.userAgent.includes("Firefox"),this.isOnLine=window.navigator.onLine,this.baseParams={rcm_id:e.rcmId,counter_type:e.isAmp?"amp":"web",session_id:U(),ruid:e.ruid,adtech_uid:e.adtechUid,adtech_uid_scope:e.adtechUidScope,version:"1.9.10211+g362a69b3c",env:e.env},this.baseFetchOptions={mode:"cors",credentials:"include",referrerPolicy:"no-referrer",cache:"no-store",redirect:"follow"},window.addEventListener("online",this.createConnectionListener()),window.addEventListener("offline",(()=>{this.isOnLine=!1}))}createConnectionListener(){let e;return async()=>{if(this.isOnLine=!0,!this.queue.isEmpty&&!e){e=!0;let t=0;do{const e=this.queue.shift();e&&this.sendFetch(e,!1),t++,t%10==0&&await new Promise((e=>{setTimeout(e,2e3)}))}while(!this.queue.isEmpty&&this.isOnLine);e=!1}}}enrichEventData(e){const{runtimeContext:t,userId:i,userIdScope:n,eventId:r}=e,{event:o,...d}=e.eventData,a={event_name:o,...this.baseParams,auth_uid:i,auth_uid_scope:n,pv_id:t.pvId,event_id:r,url:t.currentUrl,referrer:t.referrer,referrer_show_id:t.referrerShowId,client_ts:Date.now().toString(),session_event_number:(this.eventNumber++).toString(),meta:JSON.stringify((0,s.Fh)(d))};return u.v.log([`rcm event: ${o}`,"\nmeta:",d,"\nparams:",a]),new URLSearchParams((0,s.Fh)(a))}useBeacon(e){const t=window.navigator,i=this.endpoint;if(!t.sendBeacon||!t.sendBeacon(i,e)){if(this.isFirefox){const t=new XMLHttpRequest;t.open("POST",i,!1),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),t.withCredentials=!0;try{t.send(e)}catch(e){u.v.error({error:e,fingerprint:[`${i}: failed to send synchronous xhr from useBeacon`]})}}else this.useFetch(e,!0);u.v.info({message:"sendBeacon "+(t.sendBeacon?"failed to send":"does not exist"),fingerprint:["sendBeacon","error"]})}}useFetch(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i={...this.baseFetchOptions,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:e,keepalive:t};this.sendFetch({options:i,count:0})}sendFetch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=this.endpoint;fetch(i,e.options).then((e=>{e.ok||u.v.error({error:`${i} api error with status code=${e.status} and text=${e.statusText}`,fingerprint:[`${i} api failed`]})})).catch((n=>{t&&u.v.error({error:n,message:`${i}: client failed to fetch`,fingerprint:["Client failed to fetch"]}),this.enqueueFetch(e)}))}enqueueFetch(e){e.count++>=15||(this.queue.push(e),this.isOnLine&&this.runResendTimer())}runResendTimer(){this.resendTimer||(this.resendTimer=window.setTimeout((()=>{if(this.resendTimer=null,this.isOnLine){for(let e=0;e<10;e++){const e=this.queue.shift();if(!e)break;this.sendFetch(e,!1)}this.queue.isEmpty||this.runResendTimer()}}),2e3))}send(e,t){const i=this.enrichEventData(e);t?.transport===q.Beacon?this.useBeacon(i):this.useFetch(i)}}var N=r(177);const H="rcmrclid_list",W="rcmrclid";function K(){const e=N.L.getItem(H);if(e){let t;try{t=JSON.parse(e)}catch(e){}const[i,n]=function(e){const t={};let i=!1;if("object"==typeof e&&null!==e)for(const[n,r]of Object.entries(e))Array.isArray(r)&&r[0]&&r[1]&&Date.now()<r[1]?t[n]=r:i=!0;else i=!0;return[i,t]}(t);return i&&N.L.setItem(H,JSON.stringify(n)),n}return{}}function J(e){c.set(W,e)}var Q=r(743);class X{constructor(e,t){(0,g.A)(this,"microdataObserver",null),(0,g.A)(this,"initVideo",null),u.v.log(["rcm event: 'setup', meta:",e]),this.rcmId=e.rcmId,this.ruid=e.ruid,this.isAmp=e.isAmp??!1,this.adtechUid=e.adtechUid,this.adtechUidScope=e.adtechUidScope,this.userId=e.userId,this.userIdScope=e.userId?e.userIdScope:null,this.options=t??{},this.isFirstPVId=!0,this.runtimeContext=this.createRuntimeContext();const i=e.isActivityTrackerEnabled??!0;if(this.activityTrackerManager=i?new j:null,u.v.log(["rcm activity tracker "+(i?"enabled":"disabled")]),void 0===this.adtechUid||void 0===this.adtechUidScope){const e=(new L).getID();this.adtechUid=e.uuid,this.adtechUidScope=e.scope}this.transport=new M({env:"rcm",...e.transportConfig,adtechUid:this.adtechUid,adtechUidScope:this.adtechUidScope,ruid:this.ruid,rcmId:this.rcmId,isAmp:this.isAmp}),this.headless=(0,Q.gh)()}getOnSetupParams(){return{adtechUid:{uid:this.adtechUid,scope:this.adtechUidScope},runtimeContext:{...this.runtimeContext}}}setMeta(e){u.v.log(["rcm event: 'setMeta', meta:",e]),void 0!==e.userId&&(this.userId=e.userId),void 0!==e.userIdScope&&(this.userIdScope=this.userId?e.userIdScope:null)}sendAddToBookmarks(e){this.sendEvent({event:"rvaddbm",item_url:e.itemUrl,item_id:e.itemId})}sendAddToWatchlist(e){this.sendEvent({event:"rvaddwl",item_url:e.itemUrl,item_id:e.itemId})}sendBlockInit(e){this.sendEvent({event:"blockinit",block_id:e.blockId,item_id:e.contextItemId??void 0})}sendClick(e){this.sendEvent({event:"click",block_id:e.blockId,context_item_id:e.contextItemId,item_rcm_id:e.item.rcm_id,position:e.position,request_id:e.requestId,item_url:e.item.item_url,show_id:e.item.show_id,item_id:e.item.item_id},{transport:q.Beacon})}sendDislike(e){this.sendEvent({event:"dislike",reason:e.reason,item_rcm_id:e.rcmId||this.rcmId,item_url:e.itemUrl,show_id:e.showId,item_id:e.itemId})}sendLike(e){this.sendEvent({event:"like",reason:e.reason,item_rcm_id:e.rcmId||this.rcmId,item_url:e.itemUrl,show_id:e.showId,item_id:e.itemId})}sendPageRead(e){this.sendEvent({event:"pageread",item_id:e.itemId})}sendPageView(e){const{itemId:t}=e;this.activityTrackerRunCommand("stop"),this.updateRuntimeContext(t),this.sendEvent({event:"pageview",item_id:t}),this.activityTrackerRunCommand("start",t),this.microdataObserverRunCommand("start",t)}sendAutoPageView(e){const{itemId:t}=e;this.activityTrackerRunCommand("stop"),this.updateRuntimeContext(t),this.sendEvent({event:"autopageview",item_id:t}),this.activityTrackerRunCommand("start",t),this.microdataObserverRunCommand("start",t)}sendHubPageView(e){const{hubId:t}=e;this.activityTrackerRunCommand("stop"),this.updateRuntimeContext(),this.sendEvent({event:"hubpageview",item_id:t}),this.activityTrackerRunCommand("start",t),this.microdataObserverRunCommand("stop")}sendRemoveFromBookmarks(e){this.sendEvent({event:"rvrmbm",item_url:e.itemUrl,item_id:e.itemId})}sendRemoveFromWatchlist(e){this.sendEvent({event:"rvrmwl",item_url:e.itemUrl,item_id:e.itemId})}sendShow(e){this.sendEvent({event:"show",block_id:e.blockId,context_item_id:e.contextItemId,item_rcm_id:e.item.rcm_id,position:e.position,request_id:e.requestId,item_url:e.item.item_url,show_id:e.item.show_id,item_id:e.item.item_id})}sendShowAd(e){this.sendEvent({event:"showAd",block_id:e.blockId,context_item_id:e.contextItemId,position:e.position,request_id:e.requestId})}sendFulltextShow(e){this.activityTrackerRunCommand("stop"),this.updateRuntimeContext(e.item.item_id),this.sendEvent({event:"fulltext_show",block_id:e.blockId,context_item_id:e.contextItemId,item_rcm_id:e.item.rcm_id,position:e.position,request_id:e.requestId,item_url:e.item.item_url,show_id:"show_id"in e.item?e.item.show_id:void 0,item_id:e.item.item_id}),this.activityTrackerRunCommand("start",e.item.item_id),this.microdataObserverRunCommand("start",e.item.item_id)}sendFulltextClick(e){this.sendEvent({event:"fulltext_click",block_id:e.blockId,context_item_id:e.contextItemId,item_rcm_id:e.item.rcm_id,position:e.position,request_id:e.requestId,item_url:e.item.item_url,show_id:"show_id"in e.item?e.item.show_id:void 0,item_id:e.item.item_id},{transport:q.Beacon})}sendSubscribe(e){this.sendEvent({event:"subscribe",author_id:e.authorId,item_id:e.contextItemId??void 0})}sendUnsubscribe(e){this.sendEvent({event:"unsubscribe",author_id:e.authorId,item_id:e.contextItemId??void 0})}async setVideoInit(e){if(!this.initVideo)try{const e=await r.e(180).then(r.bind(r,416));this.initVideo=e.initVideo}catch(e){return void u.v.error({error:e,message:"VideoInit set up incorrectly"})}this.initVideo(e,{end:e=>{this.sendVideoEnd({...e})},pause:e=>{this.sendVideoPause({...e})},progress:e=>{this.sendVideoProgress({...e})},screenOff:e=>{this.sendVideoFullScreenOff({...e})},screenOn:e=>{this.sendVideoFullScreenOn({...e})},start:e=>{this.sendVideoStart({...e})}})}sendVideoFullScreenOff(e){this.sendEvent({event:"rvfoff",resource_id:String(e.resourceId),item_id:e.itemId})}sendVideoFullScreenOn(e){this.sendEvent({event:"rvfon",resource_id:String(e.resourceId),item_id:e.itemId})}sendVideoProgress(e){this.sendEvent({event:"rvp",resource_id:String(e.resourceId),duration:e.duration,ping_duration:e.pingDuration,progress:e.progress,item_id:e.itemId})}sendVideoPause(e){this.sendEvent({event:"rvpause",resource_id:String(e.resourceId),item_id:e.itemId})}sendVideoStart(e){this.sendEvent({event:"rvs",resource_id:String(e.resourceId),item_id:e.itemId})}sendVideoEnd(e){this.sendEvent({event:"rve",resource_id:String(e.resourceId),item_id:e.itemId})}sendActivityPing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:q.Xhr;this.sendEvent({event:"activityPing",activity_counters:e.activityCounters,activity_durations:e.activityDurations,duration:e.duration,position:e.num,item_id:e.itemId},{transport:t})}sendScrollEnd(e){this.sendEvent({event:"scrollEnd",duration:e.duration,portion:e.portion,item_id:e.itemId})}sendReadEnd(e){this.sendEvent({event:"readEnd",duration:e.duration,portion:e.portion,item_id:e.itemId})}sendOrderCheckout(e){this.sendEvent({event:"orderCheckout",item_id:e.itemId,checkout_id:e.checkoutId},{transport:q.Beacon})}sendOrderPaid(e){this.sendEvent({event:"orderPaid",item_id:e.itemId,checkout_id:e.checkoutId},{transport:q.Beacon})}sendBookingCheckout(e){this.sendEvent({event:"bookingCheckout",item_id:e.itemId,checkout_id:e.checkoutId},{transport:q.Beacon})}sendBookingDone(e){this.sendEvent({event:"bookingDone",item_id:e.itemId,checkout_id:e.checkoutId},{transport:q.Beacon})}sendSearch(e){this.sendEvent({event:"search",text:e.text.trim().substring(0,100),request_id:e.requestId})}sendSearchShow(e){this.sendEvent({event:"searchShow",item_rcm_id:e.item.rcm_id,position:e.position,request_id:e.requestId,show_id:e.item.show_id,item_id:e.item.item_id})}sendSearchClick(e){this.sendEvent({event:"searchClick",item_rcm_id:e.item.rcm_id,position:e.position,request_id:e.requestId,show_id:e.item.show_id,item_id:e.item.item_id},{transport:q.Beacon})}sendExternalClick(e){this.sendEvent({event:"externalClick",block_id:e.blockId,context_item_id:e.contextItemId,item_rcm_id:e.item.rcm_id,position:e.position,item_url:e.item.item_url,item_id:e.item.item_id},{transport:q.Beacon})}sendExternalShow(e){this.sendEvent({event:"externalShow",block_id:e.blockId,context_item_id:e.contextItemId,item_rcm_id:e.item.rcm_id,position:e.position,item_url:e.item.item_url,item_id:e.item.item_id})}createRuntimeContext(){const e=function(){let e;const t=window.location.hash;return t&&t.startsWith(`#${W}=`)&&(e=t.substring(10)||void 0),J(e),e}();return{currentUrl:this.isAmp?window.context?.canonicalUrl:window.location.href,referrer:this.isAmp?window.context?.referrer:this.runtimeContext?.currentUrl?this.runtimeContext.currentUrl:document.referrer,referrerShowId:e,pvId:U()}}updateRuntimeContext(e){this.isFirstPVId?this.isFirstPVId=!1:this.runtimeContext=this.createRuntimeContext();const t=this.options.storeRcmClickId;if(e&&t?.enable){const i=this.runtimeContext.referrerShowId;i?function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:14400;const n=K();n[e]=[t,Date.now()+1e3*i],N.L.setItem(H,JSON.stringify(n))}(e,i,t.expires):this.runtimeContext.referrerShowId=function(e){const t=K();let i;return t[e]&&(i=t[e][0]),J(i),i}(e)}}async microdataObserverRunCommand(e,t){if(!this.microdataObserver){if(!this.options.microdata?.enable)return;try{const e=await r.e(9).then(r.bind(r,455));this.microdataObserver=new e.MicrodataObserver}catch(e){return void u.v.error({error:e,message:"MicrodataObserver set up incorrectly"})}}"start"===e&&t?this.microdataObserver.observe(t,(e=>{this.sendScrollEnd({...e,itemId:t})}),(e=>{this.sendReadEnd({...e,itemId:t})})):"stop"===e&&this.microdataObserver.stopObserving()}activityTrackerRunCommand(e,t){this.activityTrackerManager&&("start"===e&&t?this.activityTrackerManager.start(((e,i)=>{this.sendActivityPing({...e,itemId:t},i)})):"stop"===e&&this.activityTrackerManager.stop())}sendEvent(e,t){this.headless?u.v.info({message:"The headless browser is detected",tags:[["event",e.event]],fingerprint:["Headless browser"],forcedHeadlessSentry:!0}):this.transport.send({eventId:U(),eventData:e,userId:this.userId,userIdScope:this.userIdScope,runtimeContext:this.runtimeContext},t)}}let z=function(e){return e.Partner="partner",e.SberID="sber_id",e.RamblerID="rambler_id",e}({});const G=(e,t)=>"number"===t?String(e):null,Z=e=>{return t=z,(i=e)&&("string"==typeof i||"number"==typeof i)&&Object.values(t).includes(i)?null:`${e} is not a valid scope`;var t,i},Y=!0,ee={s:{type:"string",toType:G},b:{type:"boolean",toType:e=>!!e},o:{type:"object"},n:{type:"number",toType:(e,t)=>{if("string"===t){const t=e.trim();if(t.length){const e=Number(t);if(!Number.isNaN(e))return e}}return null}},f:{type:"function"},sn:{type:"string",nullable:!0,toType:G}},te={s:{...ee.s,required:Y},b:{...ee.b,required:Y},o:{...ee.o,required:Y},n:{...ee.n,required:Y},f:{...ee.f,required:Y},sn:{...ee.sn,required:Y}},ie=[["item_id",te.s],["item_url",ee.s],["rcm_id",te.s],["show_id",te.s]],ne=[["item_id",te.s],["item_url",ee.s],["rcm_id",te.s]],re=[["itemId",te.s]],oe=[...re,["itemUrl",te.s]],se=[...re,["checkoutId",ee.s]],de=[...oe,["rcmId",ee.s],["showId",ee.s],["reason",ee.s]],ae=[["blockId",te.s],["requestId",ee.sn],["contextItemId",ee.sn],["position",te.n],["item",{...te.o,model:ie}]],ce=[["authorId",te.s],["contextItemId",ee.sn]],ue=[...re,["resourceId",te.n]],le=[...re,["duration",te.n],["portion",te.n]],he=[["blockId",ee.s],["requestId",ee.sn],["contextItemId",ee.sn],["position",te.n],["item",{...te.o,model:ne}]],me=[["requestId",te.s],["position",te.n],["item",{...te.o,model:ie}]],pe={setup:[["rcmId",te.s],["userId",ee.sn],["userIdScope",{...ee.sn,specialCheck:Z}],["isActivityTrackerEnabled",ee.b],["isAmp",ee.b],["ruid",{...ee.sn,specialCheck:e=>"string"!=typeof e||32!==e.length||/[^0-9A-F]/i.test(e)?`${e} is not a 32-digit hex number`:null}],["adtechUid",ee.sn],["adtechUidScope",ee.sn],["transportConfig",{...ee.o,model:[["env",ee.s],["endpoint",ee.s]]}]],onLoad:te.f,onSetup:te.f,bindBlock:te.o,unbindBlock:te.o,bindSearchResult:te.o,unbindSearchResult:te.o,setMeta:[["userId",ee.sn],["userIdScope",{...ee.sn,specialCheck:Z}]],addToBookmarks:oe,addToWatchlist:oe,blockinit:[["contextItemId",ee.sn],["blockId",te.s]],click:ae,fulltextClick:e=>e.item&&"object"==typeof e.item&&"show_id"in e.item?ae:he,show:ae,fulltextShow:e=>e.item&&"object"==typeof e.item&&"show_id"in e.item?ae:he,like:de,dislike:de,pageread:re,pageview:re,autopageview:re,hubpageview:[["hubId",te.s]],readEnd:le,scrollEnd:le,removeFromBookmarks:oe,removeFromWatchlist:oe,subscribe:ce,unsubscribe:ce,videoInit:[...re,["parentId",te.s],["resourceId",te.n],["playerOptions",ee.o],["onReady",ee.f]],videoFullScreenOff:ue,videoFullScreenOn:ue,videoPause:ue,videoStart:ue,videoEnd:ue,videoProgress:[...ue,["duration",te.n],["progress",te.n],["pingDuration",te.n]],showAd:[["blockId",te.s],["position",te.n],["requestId",ee.sn],["contextItemId",ee.sn]],activityPing:[...re,["duration",te.n],["activityCounters",te.s],["activityDurations",te.s],["num",ee.n]],orderCheckout:se,orderPaid:se,bookingCheckout:se,bookingDone:se,search:[["text",te.s],["requestId",ee.s]],searchShow:me,searchClick:me,externalClick:he,externalShow:he},ve=(e,t,i)=>{let n,r=[],o=[];if("string"==typeof e){if(Array.isArray(i))n=i;else{const i=pe[e];Array.isArray(i)?n=i:"function"==typeof i?n=i(t):void 0!==i&&(n=[["userMeta",i]],t={userMeta:t})}if(n)if("object"==typeof t&&null!==t)for(const[i,s]of n){let n=t[i];if(void 0===n&&s.required)r.push(`Required param "${i}" is missed in "${e}" event`);else if(void 0!==n){if(null===n&&s.nullable)continue;if("object"===s.type){if(null===n){r.push(`Required param "${i}" is equal to "null" in "${e}" event`);continue}if(s.model){const t=ve(`${e}.${i}`,n,s.model);t.errorMsg.length&&(r=r.concat(t.errorMsg)),t.warnMsg.length&&(o=o.concat(t.warnMsg));continue}}let d=typeof n;if(s.type!==d){if(!s.toType){r.push(`Param "${i}": ${String(n)} is not of type ${s.type} in "${e}" event`);continue}{const o=s.toType(n,d);if(null===o){r.push(`Cannot coerce type of param "${i}": ${JSON.stringify(n)} (${d}) to ${s.type} in "${e}" event`);continue}t[i]=o,n=o,d=s.type}}if(s.specialCheck){const e=s.specialCheck(n);e&&(o.push(`Param "${i}": ${e}`),delete t[i])}"string"===d&&""===n.trim()&&(s.required?r.push(`Param "${i}": is empty string in "${e}" event`):(delete t[i],n=void 0))}}else r.push(`Meta is not an object for event=${e}`);else o.push(`Unknown event ${e}`)}else r.push("Event name is not a string, type="+typeof e);return{errorMsg:r,warnMsg:o}},fe=[],ge={options:{storeRcmClickId:{enable:!0}}},be="RCM-7BA1",ye={},Ie={[be]:ge};let ke,we;function _e(e,t){if("setup"===e){if(we)return;ke="string"==typeof t?.rcmId&&t.rcmId||"none";const e=[["rcmId",ke],["amp",String(!!t?.isAmp)]];if(u.v.setTags(e),fe.includes(ke))return void console.warn(`[rcm warning] ${ke} was filtered`)}else if(!we)return;const{warnMsg:i,errorMsg:n}=ve(e,t);if(i.forEach((e=>{u.v.warn({message:e,fingerprint:["Validation",ke],isConsole:!0,sentryPercentage:0})})),n.length)n.forEach((e=>{u.v.error({error:e,fingerprint:["Validation",ke],isConsole:!0})}));else try{switch(e){case"setup":{const e=function(e){return Ie[e]||ye[e]&&Ie[ye[e]]}(t.rcmId);we=new X({...e?.setup,...t},e?.options),_e.isInit=!0;break}case"onLoad":t(o.Ready);break;case"onSetup":t(we.getOnSetupParams());break;case"setMeta":we.setMeta(t);break;case"bindBlock":(e=>{if(h)return void h.bindBlock(e);l||(l=r.e(249).then(r.bind(r,68)),l.then((e=>{h=e;for(const e of m.values())for(const t of e)h.bindBlock(t);m.clear()})).catch((e=>{u.v.error({error:e.message,message:"Failed to load CustomBlockHandler"})})));const t=m.get(e.container)||[];t.push(e),m.set(e.container,t)})(t);break;case"unbindBlock":(e=>{h?h.unbindBlock(e):m.delete(e.container)})(t);break;case"addToBookmarks":we.sendAddToBookmarks(t);break;case"addToWatchlist":we.sendAddToWatchlist(t);break;case"blockinit":we.sendBlockInit(t);break;case"click":we.sendClick(t);break;case"dislike":we.sendDislike(t);break;case"like":we.sendLike(t);break;case"pageread":we.sendPageRead(t);break;case"pageview":we.sendPageView(t);break;case"autopageview":we.sendAutoPageView(t);break;case"hubpageview":we.sendHubPageView(t);break;case"removeFromBookmarks":we.sendRemoveFromBookmarks(t);break;case"removeFromWatchlist":we.sendRemoveFromWatchlist(t);break;case"show":we.sendShow(t);break;case"subscribe":we.sendSubscribe(t);break;case"unsubscribe":we.sendUnsubscribe(t);break;case"videoFullScreenOff":we.sendVideoFullScreenOff(t);break;case"videoInit":we.setVideoInit(t);break;case"videoFullScreenOn":we.sendVideoFullScreenOn(t);break;case"videoProgress":we.sendVideoProgress(t);break;case"videoPause":we.sendVideoPause(t);break;case"videoStart":we.sendVideoStart(t);break;case"videoEnd":we.sendVideoEnd(t);break;case"fulltextShow":we.sendFulltextShow(t);break;case"fulltextClick":we.sendFulltextClick(t);break;case"showAd":we.sendShowAd(t);break;case"activityPing":we.sendActivityPing(t);break;case"scrollEnd":we.sendScrollEnd(t);break;case"readEnd":we.sendReadEnd(t);break;case"orderCheckout":we.sendOrderCheckout(t);break;case"orderPaid":we.sendOrderPaid(t);break;case"bookingCheckout":we.sendBookingCheckout(t);break;case"bookingDone":we.sendBookingDone(t);break;case"search":we.sendSearch(t);break;case"searchShow":we.sendSearchShow(t);break;case"searchClick":we.sendSearchClick(t);break;case"externalClick":we.sendExternalClick(t);break;case"bindSearchResult":(e=>{if(v)return void v.bindSearchResult(e);p||(p=r.e(530).then(r.bind(r,807)),p.then((e=>{v=e;for(const e of f.values())for(const t of e)v.bindSearchResult(t);f.clear()})).catch((e=>{u.v.error({error:e.message,message:"Failed to load SearchResultHandler"})})));const t=f.get(e.container)||[];t.push(e),f.set(e.container,t)})(t);break;case"unbindSearchResult":(e=>{v?v.unbindSearchResult(e):f.delete(e.container)})(t);break;case"externalShow":we.sendExternalShow(t)}}catch(e){u.v.error({error:e})}}_e.isInit=!1,_e.config=c;const Se=(e,t)=>{"function"==typeof e?e(t):u.v.error({error:"Meta is not a function for event=onLoad"})},Ee=(e,t)=>(_e("setup",e),!!_e.isInit&&(window.rcm=_e,t.forEach((e=>{let[t,i]=e;return window.rcm(t,i)})),!0)),Ce=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];Ce.q.push(t)};Ce.isInit=!0,Ce.q={innerQueue:[],push(e){const[t,i]=e;"onLoad"===t?Se(i,o.Pending):"setup"===t?Ee(i,this.innerQueue):this.innerQueue.push(e)}};(()=>{if(!window.rcm)return void u.v.error({error:"Rcm is set up incorrectly",fingerprint:["Rcm is set up incorrectly"]});if(window.rcm.isInit)return;if(!(0,Q.PK)())return;let e,t=Array.isArray(window.rcm.q)?window.rcm.q:[];t=t.filter((t=>{switch(t[0]){case"onLoad":return Se(t[1],o.Pending),!1;case"setup":return e||(e=t),!1;default:return!0}})),e&&Ee(e[1],t)||(Ce.q.innerQueue=t,window.rcm=Ce)})()})();